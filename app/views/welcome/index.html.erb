
<div class="row dash-big-container">
  <div class="col-sm-10 col-sm-offset-1">
    <h2>Delivery Vehicles</h2>
  </div>

  <% @delivery_trucks.each do |truck|%>
<<<<<<< HEAD
=======
<<<<<<< HEAD

=======
>>>>>>> clay
    <% @newWeight = truck.weightCapacity.to_i %>
    <% @vehicles.each do |vehicle| %>
      <% if vehicle.truckId.to_i == truck.id.to_i %>
        <% @newWeight -= vehicle.actualWeight.to_i %>
      <% end %>
    <% end %>
    <% truck.update(currentWeight: @newWeight.to_i) %>

<<<<<<< HEAD



=======
>>>>>>> clay
>>>>>>> 10265d3678c8c6194d4dbedc2199db8383f8b6ad
    <div class="col-sm-10 col-sm-offset-1">
      <div class="well">
        <table width="100%">
          <thead>
            <th width="55%"><h4>Delivery Truck</h4></th>
            <th width="30%"><h4>Remaining Capacity</h4></th>
            <th><h4>Action</h4></th>
          </thead>
          <tbody>
              <tr>
                <td><h5><%= link_to truck.name, truck %></h5></td>
<<<<<<< HEAD
                <td><h5><%= truck.weightCapacity %></h5></td>
=======
<<<<<<< HEAD
                <td><h5><%= truck.currentWeight %></h5></td>
=======
                <td><h5><%= @newWeight %></h5></td>
>>>>>>> clay
>>>>>>> 10265d3678c8c6194d4dbedc2199db8383f8b6ad
                <td><select onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">
                <option selected disabled>Load Vehicle</option>
                <% @vehicles.each do |vehicle| %>
                  <option value=<%= "/?truckId=#{URI.escape(truck.id.to_s)}&carId=#{URI.escape(vehicle.id.to_s)}"%>><%= vehicle.name %></option>
                <%end%>
              </select></td>
              </tr>
          <tr>
            <td><h4>Loaded Vehicle</h4></td>
            <td><h4>Weight</h4></td>
            <td><h4>Action</h4></td>
          </tr>
          <% @vehicles.each do |vehicle|%>
            <% if vehicle.truckId.to_s == truck.id.to_s %>
            <tr>
              <td><h5><%= link_to vehicle.name, vehicle %></h5></td>
              <td><h5><%= vehicle.actualWeight %></h5></td>
              <td><select onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">
                <option selected disabled>Move Vehicle</option>
                <option value=<%= "/?truckId=#{URI.escape("nil")}&carId=#{URI.escape(vehicle.id.to_s)}"%>>Remove
                <% @delivery_trucks.each do |truck| %>
                  <option value=<%= "/?truckId=#{URI.escape(truck.id.to_s)}&carId=#{URI.escape(vehicle.id.to_s)}"%>>Move to <%= truck.name %></option>
                <%end%>
                </option>
              </select></td>
              </tr>
            <% end %>
          <% end %>
          </tbody>
        </table>
      </div>
    </div>
  <% end %>
  <div class="row">
    <div class="col-sm-10 col-sm-offset-1">
      <h2>Vehicles Ready For Dispatch</h2></div>
    </div>
  </div>

  <div class="row">
    <div class="col-sm-10 col-sm-offset-1">
      <div class="well">
        <select onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">
            <option selected disabled>Filter By Destination</option>
            <option value="/">All Destinations</option>
          <% @vehicles.each do |vehicle| %>
            <option value=<%= "/?destination=#{URI.escape(vehicle.destination)}"%>><%= vehicle.destination %></option>
            <%end%>
        </select>
        <table width="100%">
          <thead>
            <th width="30%"><h4>Available Vehicles</h4></th>
            <th width="25%"><h4>Origin City</h4></th>
            <th width="25%"><h4>Destination City</h4></th>
            <th width="20%"><h4>Trip Distance</h4></th>
            <th width="20%"><h4>Pick Up With</h4></th>
          </thead>
          <tbody>
            <%@tableVehicles.each do |vehicle|%>
              <tr>
                <td><h5><%= link_to vehicle.name, vehicle %></h5></td>
                <td><h5><%= vehicle.origin %></h5></td>
                <td><h5><%= vehicle.destination %></h5></td>
                <td><h5><%= vehicle.distance %></h5></td>
<<<<<<< HEAD
                <td><select onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">
                  <option selected disabled>Available Trucks</option>
                  <% @delivery_trucks.each do |truck| %>
                    <option value=<%= "/?truckId=#{URI.escape(truck.id.to_s)}&carId=#{URI.escape(vehicle.id.to_s)}"%>><%= truck.name %></option>
                  <%end%>
                </select></td>
=======
<<<<<<< HEAD

                <td>
                  <select onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">
=======
                <td> <select onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">
>>>>>>> clay
                    <% @delivery_trucks.each do |truck| %>
                      <% if vehicle.truckId.to_i == truck.id.to_i %>
                        <option selected disabled> Currently on <%= truck.name%> </option>
                        <option value=<%= "/?truckId=#{URI.escape("nil")}&carId=#{URI.escape(vehicle.id.to_s)}"%>>Remove</option>
                        <% break %>
                        <% elsif truck == @delivery_trucks.last %>
                        <option selected disabled>Available</option>
                      <% end %>
                    <% end %>
                    <% @delivery_trucks.each do |truck| %>
                      <option value=<%= "/?truckId=#{URI.escape(truck.id.to_s)}&carId=#{URI.escape(vehicle.id.to_s)}"%>><%= truck.name %></option>
                    <%end%>
<<<<<<< HEAD
                  </select>
                </td>

=======
                  </select></td>
>>>>>>> clay
>>>>>>> 10265d3678c8c6194d4dbedc2199db8383f8b6ad
              </tr>
            <%end%>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
